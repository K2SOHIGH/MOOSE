#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import os
import argparse
import shutil
import multiprocessing
import yaml
from utils import utils
from utils import log

logger = log.setlogger(os.path.basename(__file__))
logger.info(os.path.basename(__file__))

    
def get_args():
    parser = argparse.ArgumentParser(
        prog= os.path.basename(__file__) ,
        description='Setup anvi\'o databases.')

    parser.add_argument('-d','--dir-anvio', 
        default=None,  
        type=str, 
        help = "Directory where anvio databases will be stored. [doesn't work using anvio-dev ]")

    parser.add_argument('-r','--reset', 
        default=None,  
        action="store_true",
        help = "reset anvi'o databases.")  

    parser.add_argument(
        '-t',
        '--threads',
        type = int,
        default = multiprocessing.cpu_count()-1,
        help = "number of threads",
    )

    parser.add_argument('--snakargs', dest='snakargs', type=str, default="",
            help='snakmake arguments')

    args = parser.parse_args()
    return args


def main():
    args = get_args()
    f = os.path.abspath(os.path.join(__file__, ".." , ".." , "resources" , "anviodb.txt" )  )
    args.file = f

    utils.module(
        "anvio-setup-databases",
        os.path.join( os.path.abspath( os.path.dirname(__file__)) , "../condaenvs"),
        args
    )

if __name__ == "__main__":
    main()



    